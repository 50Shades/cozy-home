{"version":3,"sources":["webpack:///./src/lib/tutorial.js"],"names":["isTutorial","display","window","location","pathname","endsWith","t","trackerInstance","shouldTrackTutorial","pageURLsForTracking","tutorial","setOptions","overlayOpacity","showBullets","hidePrev","hideNext","exitOnEsc","exitOnOverlayClick","disableInteraction","doneLabel","nextLabel","steps","element","isEmptyView","document","querySelectorAll","intro","tooltipClass","position","cozyBarMenuButton","onafterchange","stepIndex","_options","i","l","length","targetElement","trackingURL","push","doneButton","className","classList","remove","add","oncomplete","setTimeout","click","hash","start","clickZone","clickAction","e","target","tagName","stopPropagation","nextStep","elem","onclick"],"mappings":"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","file":"0.b691e63a06ac90cfa202.hot-update.js","sourcesContent":["import { introJs } from 'intro.js'\nimport { shouldEnableTracking, getTracker } from 'cozy-ui/react/helpers/tracker'\n\nexport function isTutorial() {\n  return window.location.pathname.endsWith('/intro')\n}\n\nexport function display(t) {\n  const trackerInstance = getTracker()\n  const shouldTrackTutorial = shouldEnableTracking() && trackerInstance\n  const pageURLsForTracking = [\n    'tutorial/automate',\n    'tutorial/apps',\n    'tutorial/complete'\n  ]\n  const tutorial = introJs()\n  tutorial\n    .setOptions({\n      overlayOpacity: 0.75,\n      showBullets: false,\n      hidePrev: true,\n      hideNext: true,\n      exitOnEsc: false,\n      exitOnOverlayClick: false,\n      disableInteraction: true,\n      doneLabel: `${t('tutorial.menu_apps.button')}`,\n      nextLabel: `${t('tutorial.cozy_collect.button')}`,\n      steps: [\n        {\n          element: isEmptyView\n            ? document.querySelectorAll('[data-tutorial=empty-view]')[0]\n            : document.querySelectorAll('[data-tutorial=add-service]')[0],\n          intro: `<h1>${t('tutorial.cozy_collect.title')}</h1><div>${t(\n            'tutorial.cozy_collect.text'\n          )}</div>`,\n          tooltipClass: isEmptyView ? 'tooltipEmptyBottom' : 'tooltipBottom',\n          position: 'bottom'\n        },\n        {\n          element: cozyBarMenuButton,\n          intro: `<h1>${t('tutorial.menu_apps.title')}</h1><div>${t(\n            'tutorial.menu_apps.text'\n          )}</div>`,\n          tooltipClass: 'tooltipApps',\n          position: 'bottom'\n        }\n      ]\n    })\n    .onafterchange(targetElement => {\n      if (shouldTrackTutorial) {\n        let stepIndex\n        let steps = tutorial._options.steps\n        for (let i = 0, l = steps.length; i < l; ++i) {\n          if (steps[i].element === targetElement) {\n            stepIndex = i\n            break\n          }\n        }\n\n        const trackingURL = pageURLsForTracking[stepIndex]\n        trackerInstance.push(['setCustomUrl', trackingURL])\n        trackerInstance.push(['trackPageView'])\n      }\n\n      // The intro.js button for the last step is hidden, so we need to show it when we arrive on it\n      const doneButton = document.querySelectorAll('.introjs-donebutton')[0]\n      if (!doneButton) return // step 1, no done button yet\n\n      if (targetElement.className === cozyBarMenuButton.className) {\n        doneButton.classList.remove('introjs-skipbutton')\n      } else {\n        doneButton.classList.add('introjs-skipbutton')\n      }\n    })\n    .oncomplete(() => {\n      if (shouldTrackTutorial) {\n        trackerInstance.push([\n          'setCustomUrl',\n          pageURLsForTracking[pageURLsForTracking.length - 1]\n        ])\n        trackerInstance.push(['trackPageView'])\n      }\n\n      // When a click occurs on the last tutorial button, it seems that there\n      // is some kind of conflict or event capture that block the click() call\n      // on cozyBarMenuButton. So we must delay a little bit this call. It is\n      // really dirty and hackish and we should instead call directly a method\n      // on the Cozy-Bar to show the app panel.\n      setTimeout(() => cozyBarMenuButton.click(), 10)\n      window.location.hash = '#/connected'\n    })\n    .start()\n  const clickZone =\n    '.introjs-disableInteraction, .introjs-overlay, .introjs-tooltiptext, .introjs-tooltipbuttons'\n  const clickAction = e => {\n    if (e.target.tagName !== 'A') {\n      e.stopPropagation()\n      tutorial.nextStep()\n    }\n  }\n  for (const elem of document.querySelectorAll(clickZone)) {\n    elem.onclick = clickAction\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/tutorial.js"],"sourceRoot":""}