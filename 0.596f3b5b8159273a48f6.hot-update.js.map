{"version":3,"sources":["webpack:///./src/lib/tutorial.js"],"names":["isTutorial","display","window","location","pathname","endsWith","t","isSmall","document","querySelectorAll","offsetParent","console","debug","isEmptyView","length","cozyBarMenuClass","cozyBarMenuButton","trackerInstance","shouldTrackTutorial","pageURLsForTracking","tutorial","setOptions","overlayOpacity","showBullets","hidePrev","hideNext","exitOnEsc","exitOnOverlayClick","disableInteraction","doneLabel","nextLabel","steps","element","intro","tooltipClass","position","onafterchange","stepIndex","_options","i","l","targetElement","trackingURL","push","doneButton","className","classList","remove","add","oncomplete","setTimeout","click","hash","start","clickZone","clickAction","e","target","tagName","stopPropagation","nextStep","elem","onclick"],"mappings":"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","file":"0.596f3b5b8159273a48f6.hot-update.js","sourcesContent":["import { introJs } from 'intro.js'\nimport { shouldEnableTracking, getTracker } from 'cozy-ui/react/helpers/tracker'\n\nexport function isTutorial() {\n  return window.location.pathname.endsWith('/intro')\n}\n\nexport function display(t) {\n  const isSmall = document.querySelectorAll('.coz-nav')[0].offsetParent === null\n  console.debug('display', isSmall)\n  const isEmptyView = !!document.querySelectorAll('[data-tutorial=empty-view]')\n    .length\n  const cozyBarMenuClass = isSmall\n    ? '[data-tutorial=apps-mobile]'\n    : '[data-tutorial=apps]'\n  const cozyBarMenuButton = document.querySelectorAll(cozyBarMenuClass)[0]\n  const trackerInstance = getTracker()\n  const shouldTrackTutorial = shouldEnableTracking() && trackerInstance\n  const pageURLsForTracking = [\n    'tutorial/automate',\n    'tutorial/apps',\n    'tutorial/complete'\n  ]\n  const tutorial = introJs()\n  tutorial\n    .setOptions({\n      overlayOpacity: 0.75,\n      showBullets: false,\n      hidePrev: true,\n      hideNext: true,\n      exitOnEsc: false,\n      exitOnOverlayClick: false,\n      disableInteraction: true,\n      doneLabel: `${t('tutorial.menu_apps.button')}`,\n      nextLabel: `${t('tutorial.cozy_collect.button')}`,\n      steps: [\n        {\n          element: isEmptyView\n            ? document.querySelectorAll('[data-tutorial=empty-view]')[0]\n            : document.querySelectorAll('[data-tutorial=top-bar]')[0],\n          intro: `<h1>${t('tutorial.cozy_collect.title')}</h1><div>${t(\n            'tutorial.cozy_collect.text'\n          )}</div>`,\n          tooltipClass: isEmptyView ? 'tooltipEmptyBottom' : 'tooltipBottom',\n          position: 'bottom'\n        },\n        {\n          element: cozyBarMenuButton,\n          intro: `<h1>${t('tutorial.menu_apps.title')}</h1><div>${t(\n            'tutorial.menu_apps.text'\n          )}</div>`,\n          tooltipClass: 'tooltipApps',\n          position: isSmall ? 'right' : 'bottom'\n        }\n      ]\n    })\n    .onafterchange(targetElement => {\n      if (shouldTrackTutorial) {\n        let stepIndex\n        let steps = tutorial._options.steps\n        for (let i = 0, l = steps.length; i < l; ++i) {\n          if (steps[i].element === targetElement) {\n            stepIndex = i\n            break\n          }\n        }\n\n        const trackingURL = pageURLsForTracking[stepIndex]\n        trackerInstance.push(['setCustomUrl', trackingURL])\n        trackerInstance.push(['trackPageView'])\n      }\n\n      // The intro.js button for the last step is hidden, so we need to show it when we arrive on it\n      const doneButton = document.querySelectorAll('.introjs-donebutton')[0]\n      if (!doneButton) return // step 1, no done button yet\n\n      if (targetElement.className === cozyBarMenuButton.className) {\n        doneButton.classList.remove('introjs-skipbutton')\n      } else {\n        doneButton.classList.add('introjs-skipbutton')\n      }\n    })\n    .oncomplete(() => {\n      if (shouldTrackTutorial) {\n        trackerInstance.push([\n          'setCustomUrl',\n          pageURLsForTracking[pageURLsForTracking.length - 1]\n        ])\n        trackerInstance.push(['trackPageView'])\n      }\n\n      // When a click occurs on the last tutorial button, it seems that there\n      // is some kind of conflict or event capture that block the click() call\n      // on cozyBarMenuButton. So we must delay a little bit this call. It is\n      // really dirty and hackish and we should instead call directly a method\n      // on the Cozy-Bar to show the app panel.\n      setTimeout(() => cozyBarMenuButton.click(), 10)\n      window.location.hash = '#/connected'\n    })\n    .start()\n  const clickZone =\n    '.introjs-disableInteraction, .introjs-overlay, .introjs-tooltiptext, .introjs-tooltipbuttons'\n  const clickAction = e => {\n    if (e.target.tagName !== 'A') {\n      e.stopPropagation()\n      tutorial.nextStep()\n    }\n  }\n  for (const elem of document.querySelectorAll(clickZone)) {\n    elem.onclick = clickAction\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/tutorial.js"],"sourceRoot":""}