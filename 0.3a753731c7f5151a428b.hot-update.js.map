{"version":3,"sources":["webpack:///./src/lib/tutorial.js"],"names":["isTutorial","display","window","location","pathname","endsWith","t","appsPanel","document","querySelectorAll","servicesPanel","element","Error","trackerInstance","shouldTrackTutorial","pageURLsForTracking","tutorial","setOptions","overlayOpacity","showBullets","hidePrev","hideNext","exitOnEsc","exitOnOverlayClick","disableInteraction","doneLabel","nextLabel","steps","intro","tooltipClass","position","onafterchange","stepIndex","_options","i","l","length","targetElement","trackingURL","push","doneButton","className","cozyBarMenuButton","classList","remove","add","oncomplete","setTimeout","click","hash","start","clickZone","clickAction","e","target","tagName","stopPropagation","nextStep","elem","onclick"],"mappings":"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","file":"0.3a753731c7f5151a428b.hot-update.js","sourcesContent":["import { introJs } from 'intro.js'\nimport { shouldEnableTracking, getTracker } from 'cozy-ui/react/helpers/tracker'\n\nexport function isTutorial() {\n  return window.location.pathname.endsWith('/intro')\n}\n\nexport function display(t) {\n  const appsPanel = !!document.querySelectorAll('[data-tutorial=apps]')[0]\n  const servicesPanel = !!document.querySelectorAll(\n    '[data-tutorial=services]'\n  )[0]\n\n  for (const element in [appsPanel, servicesPanel]) {\n    if (!element) throw new Error('Missing tutorial element.')\n  }\n\n  const trackerInstance = getTracker()\n  const shouldTrackTutorial = shouldEnableTracking() && trackerInstance\n  const pageURLsForTracking = [\n    'tutorial/automate',\n    'tutorial/apps',\n    'tutorial/complete'\n  ]\n  const tutorial = introJs()\n  tutorial\n    .setOptions({\n      overlayOpacity: 0.75,\n      showBullets: false,\n      hidePrev: true,\n      hideNext: true,\n      exitOnEsc: false,\n      exitOnOverlayClick: false,\n      disableInteraction: true,\n      doneLabel: `${t('tutorial.menu_apps.button')}`,\n      nextLabel: `${t('tutorial.cozy_collect.button')}`,\n      steps: [\n        {\n          element: appsPanel,\n          intro: `<h1>${t('tutorial.menu_apps.title')}</h1><div>${t(\n            'tutorial.menu_apps.text'\n          )}</div>`,\n          tooltipClass: 'tooltipApps',\n          position: 'bottom'\n        },\n        {\n          element: servicesPanel\n            ? document.querySelectorAll('[data-tutorial=empty-view]')[0]\n            : document.querySelectorAll('[data-tutorial=add-service]')[0],\n          intro: `<h1>${t('tutorial.cozy_collect.title')}</h1><div>${t(\n            'tutorial.cozy_collect.text'\n          )}</div>`,\n          tooltipClass: 'tooltipBottom',\n          position: 'bottom'\n        }\n      ]\n    })\n    .onafterchange(targetElement => {\n      if (shouldTrackTutorial) {\n        let stepIndex\n        let steps = tutorial._options.steps\n        for (let i = 0, l = steps.length; i < l; ++i) {\n          if (steps[i].element === targetElement) {\n            stepIndex = i\n            break\n          }\n        }\n\n        const trackingURL = pageURLsForTracking[stepIndex]\n        trackerInstance.push(['setCustomUrl', trackingURL])\n        trackerInstance.push(['trackPageView'])\n      }\n\n      // The intro.js button for the last step is hidden, so we need to show it when we arrive on it\n      const doneButton = document.querySelectorAll('.introjs-donebutton')[0]\n      if (!doneButton) return // step 1, no done button yet\n\n      if (targetElement.className === cozyBarMenuButton.className) {\n        doneButton.classList.remove('introjs-skipbutton')\n      } else {\n        doneButton.classList.add('introjs-skipbutton')\n      }\n    })\n    .oncomplete(() => {\n      if (shouldTrackTutorial) {\n        trackerInstance.push([\n          'setCustomUrl',\n          pageURLsForTracking[pageURLsForTracking.length - 1]\n        ])\n        trackerInstance.push(['trackPageView'])\n      }\n\n      // When a click occurs on the last tutorial button, it seems that there\n      // is some kind of conflict or event capture that block the click() call\n      // on cozyBarMenuButton. So we must delay a little bit this call. It is\n      // really dirty and hackish and we should instead call directly a method\n      // on the Cozy-Bar to show the app panel.\n      setTimeout(() => cozyBarMenuButton.click(), 10)\n      window.location.hash = '#/connected'\n    })\n    .start()\n  const clickZone =\n    '.introjs-disableInteraction, .introjs-overlay, .introjs-tooltiptext, .introjs-tooltipbuttons'\n  const clickAction = e => {\n    if (e.target.tagName !== 'A') {\n      e.stopPropagation()\n      tutorial.nextStep()\n    }\n  }\n  for (const elem of document.querySelectorAll(clickZone)) {\n    elem.onclick = clickAction\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/tutorial.js"],"sourceRoot":""}