{"version":3,"sources":["webpack:///./src/components/Applications.jsx","webpack:///./src/lib/tutorial.js"],"names":["LoadingAppTiles","num","tiles","i","push","Applications","t","props","ignoredAppSlugs","client","all","data","fetchStatus","filter","includes","app","slug","map","isTutorial","display","window","location","pathname","endsWith","appsPanel","document","querySelectorAll","servicesPanel","console","debug","element","Error","trackerInstance","shouldTrackTutorial","pageURLsForTracking","tutorial","setOptions","overlayOpacity","showBullets","hidePrev","hideNext","exitOnEsc","exitOnOverlayClick","disableInteraction","doneLabel","nextLabel","steps","intro","tooltipClass","position","onafterchange","stepIndex","_options","l","length","targetElement","trackingURL","doneButton","className","cozyBarMenuButton","classList","remove","add","oncomplete","setTimeout","click","hash","start","clickZone","clickAction","e","target","tagName","stopPropagation","nextStep","elem","onclick"],"mappings":"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","file":"0.463db2b1f5e18c60434b.hot-update.js","sourcesContent":["import React from 'react'\n\nimport AppTile from './AppTile'\nimport LoadingPlaceholder from './LoadingPlaceholder'\nimport { Query } from 'cozy-client'\nimport { translate } from 'cozy-ui/react/I18n'\n\nconst LoadingAppTiles = ({ num }) => {\n  const tiles = []\n  for (let i = 0; i < num; i++) {\n    tiles.push(\n      <div className=\"item-wrapper\">\n        <header className=\"item-header\">\n          <div className=\"item-icon\">\n            <LoadingPlaceholder />\n          </div>\n        </header>\n        <h3 className=\"item-title\">\n          <LoadingPlaceholder />\n        </h3>\n      </div>\n    )\n  }\n  return <div className=\"app-list\">{tiles}</div>\n}\n\nexport const Applications = props => {\n  const { t } = props\n  const ignoredAppSlugs = ['home', 'onboarding', 'settings']\n  return (\n    <div>\n      <h2>{t('apps.title')}</h2>\n      <Query\n        query={client => {\n          return client.all('io.cozy.apps')\n        }}\n      >\n        {({ data, fetchStatus }) => {\n          return fetchStatus !== 'loaded' ? (\n            <LoadingAppTiles num=\"3\" />\n          ) : (\n            <div className=\"app-list\" data-tutorial=\"home-apps\">\n              {data\n                .filter(app => !ignoredAppSlugs.includes(app.slug))\n                .map(app => <AppTile app={app} />)}\n            </div>\n          )\n        }}\n      </Query>\n    </div>\n  )\n}\n\nexport default translate()(Applications)\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/Applications.jsx","import { introJs } from 'intro.js'\nimport { shouldEnableTracking, getTracker } from 'cozy-ui/react/helpers/tracker'\n\nexport function isTutorial() {\n  return window.location.pathname.endsWith('/intro')\n}\n\nexport function display(t) {\n  const appsPanel = document.querySelectorAll('[data-tutorial=home-apps]')[0]\n  const servicesPanel = document.querySelectorAll(\n    '[data-tutorial=home-services]'\n  )[0]\n\n  console.debug(appsPanel, servicesPanel)\n\n  for (const element in [appsPanel, servicesPanel]) {\n    if (!element) throw new Error('Missing tutorial element.')\n  }\n\n  const trackerInstance = getTracker()\n  const shouldTrackTutorial = shouldEnableTracking() && trackerInstance\n  const pageURLsForTracking = [\n    'tutorial/automate',\n    'tutorial/apps',\n    'tutorial/complete'\n  ]\n  const tutorial = introJs()\n  tutorial\n    .setOptions({\n      overlayOpacity: 0.75,\n      showBullets: false,\n      hidePrev: true,\n      hideNext: true,\n      exitOnEsc: false,\n      exitOnOverlayClick: false,\n      disableInteraction: true,\n      doneLabel: `${t('tutorial.menu_apps.button')}`,\n      nextLabel: `${t('tutorial.cozy_collect.button')}`,\n      steps: [\n        {\n          element: appsPanel,\n          intro: `<h1>${t('tutorial.menu_apps.title')}</h1><div>${t(\n            'tutorial.menu_apps.text'\n          )}</div>`,\n          tooltipClass: 'tooltipApps',\n          position: 'bottom'\n        },\n        {\n          element: servicesPanel,\n          intro: `<h1>${t('tutorial.cozy_collect.title')}</h1><div>${t(\n            'tutorial.cozy_collect.text'\n          )}</div>`,\n          tooltipClass: 'tooltipBottom',\n          position: 'bottom'\n        }\n      ]\n    })\n    .onafterchange(targetElement => {\n      if (shouldTrackTutorial) {\n        let stepIndex\n        let steps = tutorial._options.steps\n        for (let i = 0, l = steps.length; i < l; ++i) {\n          if (steps[i].element === targetElement) {\n            stepIndex = i\n            break\n          }\n        }\n\n        const trackingURL = pageURLsForTracking[stepIndex]\n        trackerInstance.push(['setCustomUrl', trackingURL])\n        trackerInstance.push(['trackPageView'])\n      }\n\n      // The intro.js button for the last step is hidden, so we need to show it when we arrive on it\n      const doneButton = document.querySelectorAll('.introjs-donebutton')[0]\n      if (!doneButton) return // step 1, no done button yet\n\n      if (targetElement.className === cozyBarMenuButton.className) {\n        doneButton.classList.remove('introjs-skipbutton')\n      } else {\n        doneButton.classList.add('introjs-skipbutton')\n      }\n    })\n    .oncomplete(() => {\n      if (shouldTrackTutorial) {\n        trackerInstance.push([\n          'setCustomUrl',\n          pageURLsForTracking[pageURLsForTracking.length - 1]\n        ])\n        trackerInstance.push(['trackPageView'])\n      }\n\n      // When a click occurs on the last tutorial button, it seems that there\n      // is some kind of conflict or event capture that block the click() call\n      // on cozyBarMenuButton. So we must delay a little bit this call. It is\n      // really dirty and hackish and we should instead call directly a method\n      // on the Cozy-Bar to show the app panel.\n      setTimeout(() => cozyBarMenuButton.click(), 10)\n      window.location.hash = '#/connected'\n    })\n    .start()\n  const clickZone =\n    '.introjs-disableInteraction, .introjs-overlay, .introjs-tooltiptext, .introjs-tooltipbuttons'\n  const clickAction = e => {\n    if (e.target.tagName !== 'A') {\n      e.stopPropagation()\n      tutorial.nextStep()\n    }\n  }\n  for (const elem of document.querySelectorAll(clickZone)) {\n    elem.onclick = clickAction\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/tutorial.js"],"sourceRoot":""}